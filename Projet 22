from matplotlib import pyplot as plt
import math

#On créé les 3 graphiques que l'on veut générer
figure, axis = plt.subplots()
figure1, axis1 = plt.subplots()
figure2, axis2 = plt.subplots()

#On filtre les données pour garder seulement celles qui vont nous servir à faire le premier graphique (sur la matière fécale)
for mouse_number in range(1,17):
    if mouse_number < 10:
        mouse_id = f"ABX00{mouse_number}"
    elif mouse_number < 100:
        mouse_id = f"ABX0{mouse_number}"
    else:
        mouse_id = f"ABX{mouse_number}"
        
    x = []
    y = []

    fd = open("/Users\daghf\OneDrive\Desktop\data_small.csv", "r")
    # skip 1rst line
    line = fd.readline()
    # retrieve 1st data line (2nd line)
    line = fd.readline()
    while line != '':
        #remove end of line character
        line = line.replace("\n", "")
        data = line.split(";")
        #filter by mouse ID
        if data[4] == mouse_id:
            if data[5] == "ABX":
                c = 'red'
            else:
                c = 'blue'
            #process only for fecal samples
            if data [2] == 'fecal':
                xvalue = float(data[7])
                yvalue = math.log10(float(data[8]))
                x.append(xvalue)
                y.append(yvalue)
                 
        line = fd.readline()
    fd.close()

    #draw curve
    axis.plot(x, y, color = c)

cecal_abx = []
cecal_plb = []
ileal_abx = []
ileal_plb = []

fd = open("/Users\daghf\OneDrive\Desktop\data_small.csv", "r")
# skip 1rst line
line = fd.readline()
# retrieve 1st data line (2nd line)
line = fd.readline()
while line != '':
    #remove end of line character
    line = line.replace("\n", "")
    data = line.split(";")
 
    # process only for Cecal samples:
    if data[2] == "cecal":
        value = math.log10(float(data[8]))
        if data [5] == "ABX":
            cecal_abx.append(value)
        else: 
            cecal_plb.append(value)
        
    # process only for ileal samples:
    if data[2] == "ileal":
        value = math.log10(float(data[8]))
        if data [5] == "ABX":
            ileal_abx.append(value)
        else: 
            ileal_plb.append(value)
    
    line = fd.readline()

fd.close()

#draw curve
axis1.violinplot([cecal_abx, cecal_plb])
axis2.violinplot([ileal_abx, ileal_plb])



figure.savefig("out.png", dpi=200)
figure1.savefig("out.png", dpi=200)
figure2.savefig("out.png", dpi=200)
